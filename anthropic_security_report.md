# MCP Security Profile: anthropic-sdk-python

## Basic Information
- **Name**: anthropic-sdk-python
- **Repository**: https://github.com/anthropics/anthropic-sdk-python
- **Primary Function**: [To be determined]
- **Evaluation Date**: 2025-05-06
- **Evaluator**: MCP Security Scanner
- **Certification Level**: Bronze

## Security Score
- **Overall Score**: 7.0/10
- **Authentication & Authorization**: 10.0/10
- **Data Protection**: 1.0/10
- **Input Validation**: 10.0/10
- **Prompt Security**: 10.0/10
- **Infrastructure Security**: 1.0/10

## Executive Summary

This security profile was automatically generated by the MCP Security Scanner. The implementation received a Bronze certification level with an overall security score of 7.0/10.

**Strengths**:
- Authentication mechanisms implemented
- HTTPS/TLS implemented for data in transit
- Input validation mechanisms present
- Rate limiting implemented
- Error handling implemented
- Logging mechanisms implemented

**Weaknesses**:
- Multiple high-severity issues in Multi-tenancy
- Multiple issues in Data Protection
- Multiple high-severity issues in Prompt Security
- Multiple issues in Rate Limiting
- Multiple issues in Dependencies
- Multiple issues in Configuration

A total of 112 security findings were identified.

## Vulnerabilities

| ID | Severity | Category | Description | Recommendation |
|---|----------|----------|-------------|----------------|
| F1 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F2 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F3 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F4 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F5 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F6 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F7 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F8 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F9 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F10 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F11 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F12 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F13 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F14 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F15 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F16 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F17 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F18 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F19 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F20 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F21 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F22 | HIGH | Multi-tenancy | Multi-tenant system may lack proper tenant isolation in queries | Ensure all database queries filter by tenant ID to prevent data leakage between tenants |
| F23 | MEDIUM | Data Protection | No encryption detected for data at rest | Implement encryption for sensitive data stored in databases or files |
| F24 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F25 | MEDIUM | Data Protection | Sensitive data may be logged | Ensure sensitive data is not included in logs |
| F26 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F27 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F28 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F29 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F30 | MEDIUM | Data Protection | Sensitive data may be logged | Ensure sensitive data is not included in logs |
| F31 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F32 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F33 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F34 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F35 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F36 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F37 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F38 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F39 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F40 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F41 | MEDIUM | Data Protection | Sensitive data may be logged | Ensure sensitive data is not included in logs |
| F42 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F43 | MEDIUM | Data Protection | Sensitive data may be logged | Ensure sensitive data is not included in logs |
| F44 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F45 | MEDIUM | Data Protection | Sensitive data may be logged | Ensure sensitive data is not included in logs |
| F46 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F47 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F48 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F49 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F50 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F51 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F52 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F53 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F54 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F55 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F56 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F57 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F58 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F59 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F60 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F61 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F62 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F63 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F64 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F65 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F66 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F67 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F68 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F69 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F70 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F71 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F72 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F73 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F74 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F75 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F76 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F77 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F78 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F79 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F80 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F81 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F82 | MEDIUM | Data Protection | Potential PII data without proper protection | Implement masking, redaction, or encryption for personally identifiable information |
| F83 | HIGH | Prompt Security | Potential prompt injection vulnerability with unsanitized user input | Sanitize user input before incorporating it into prompts and use clear role separation |
| F84 | LOW | Prompt Security | Prompts may not use clear role separation | Use explicit role separation (system/user/assistant) in prompts |
| F85 | HIGH | Prompt Security | Potential prompt injection vulnerability with unsanitized user input | Sanitize user input before incorporating it into prompts and use clear role separation |
| F86 | LOW | Prompt Security | Prompts may not use clear role separation | Use explicit role separation (system/user/assistant) in prompts |
| F87 | HIGH | Prompt Security | Potential prompt injection vulnerability with unsanitized user input | Sanitize user input before incorporating it into prompts and use clear role separation |
| F88 | LOW | Prompt Security | Prompts may not use clear role separation | Use explicit role separation (system/user/assistant) in prompts |
| F89 | LOW | Prompt Security | Prompts may not use clear role separation | Use explicit role separation (system/user/assistant) in prompts |
| F90 | LOW | Prompt Security | Prompts may not use clear role separation | Use explicit role separation (system/user/assistant) in prompts |
| F91 | LOW | Prompt Security | Prompts may not use clear role separation | Use explicit role separation (system/user/assistant) in prompts |
| F92 | LOW | Prompt Security | Prompts may not use clear role separation | Use explicit role separation (system/user/assistant) in prompts |
| F93 | LOW | Prompt Security | Prompts may not use clear role separation | Use explicit role separation (system/user/assistant) in prompts |
| F94 | LOW | Rate Limiting | Rate limiting may not be user-specific | Implement per-user rate limiting to prevent individual users from consuming all resources |
| F95 | LOW | Rate Limiting | Rate limiting may not be user-specific | Implement per-user rate limiting to prevent individual users from consuming all resources |
| F96 | LOW | Rate Limiting | Rate limiting may not be user-specific | Implement per-user rate limiting to prevent individual users from consuming all resources |
| F97 | LOW | Rate Limiting | Rate limiting may not be user-specific | Implement per-user rate limiting to prevent individual users from consuming all resources |
| F98 | LOW | Rate Limiting | Rate limiting may not be user-specific | Implement per-user rate limiting to prevent individual users from consuming all resources |
| F99 | LOW | Rate Limiting | Rate limiting may not be user-specific | Implement per-user rate limiting to prevent individual users from consuming all resources |
| F100 | LOW | Logging | Debug logging may be enabled in production | Ensure debug logging is only enabled in development environments |
| F101 | LOW | Logging | Debug logging may be enabled in production | Ensure debug logging is only enabled in development environments |
| F102 | MEDIUM | Dependencies | Dependency sniffio has no version specified, which may lead to using vulnerable versions | Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions |
| F103 | MEDIUM | Dependencies | Dependency mypy has no version specified, which may lead to using vulnerable versions | Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions |
| F104 | MEDIUM | Dependencies | Dependency respx has no version specified, which may lead to using vulnerable versions | Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions |
| F105 | MEDIUM | Dependencies | Dependency pytest has no version specified, which may lead to using vulnerable versions | Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions |
| F106 | MEDIUM | Dependencies | Dependency pytest-asyncio has no version specified, which may lead to using vulnerable versions | Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions |
| F107 | MEDIUM | Dependencies | Dependency ruff has no version specified, which may lead to using vulnerable versions | Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions |
| F108 | MEDIUM | Dependencies | Dependency time-machine has no version specified, which may lead to using vulnerable versions | Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions |
| F109 | MEDIUM | Dependencies | Dependency nox has no version specified, which may lead to using vulnerable versions | Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions |
| F110 | MEDIUM | Configuration | Sensitive configuration may not use environment variables | Use environment variables for sensitive configuration values |
| F111 | MEDIUM | Configuration | Sensitive configuration may not use environment variables | Use environment variables for sensitive configuration values |
| F112 | MEDIUM | Configuration | Sensitive configuration may not use environment variables | Use environment variables for sensitive configuration values |

## Certification Details

- **Certification Level**: Bronze
- **Justification**: Meets basic security requirements
- **Conditions**: This certification is based on automated analysis and should be verified by manual review.
- **Expiration**: 2025-05-06 + 6 months

## Detailed Findings

### HIGH Severity Findings (25)

#### 1. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/conftest.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

from __future__ import annotations

import os
import logging
from typing import TYPE_CHECKING, Iterator, AsyncIterator

import pytest
from pytest_asyncio import is_async_test

from anthropic import Anthropic, AsyncAnthropic



#### 2. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/test_client.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import gc
import os
import sys
import json
import time
import asyncio



#### 3. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_types.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

from __future__ import annotations

from os import PathLike
from typing import (
    IO,
    TYPE_CHECKING,
    Any,
    Dict,
    List,
    Type,



#### 4. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_base_client.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

from __future__ import annotations

import sys
import json
import time
import uuid
import email
import socket
import asyncio
import inspect



#### 5. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_response.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

from __future__ import annotations

import os
import inspect
import logging
import datetime
import functools
from types import TracebackType
from typing import (
    TYPE_CHECKING,



#### 6. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_legacy_response.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

from __future__ import annotations

import os
import inspect
import logging
import datetime
import functools
from typing import (
    TYPE_CHECKING,
    Any,



#### 7. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_streaming.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# Note: initially copied from https://github.com/florimondmanca/httpx-sse/blob/master/src/httpx_sse/_decoders.py
from __future__ import annotations

import abc
import json
import inspect
import warnings
from types import TracebackType
from typing import TYPE_CHECKING, Any, Generic, TypeVar, Iterator, AsyncIterator, cast
from typing_extensions import Self, Protocol, TypeGuard, override, get_origin, runtime_checkable



#### 8. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_client.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import os
from typing import Any, Union, Mapping
from typing_extensions import Self, override

import httpx




#### 9. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_models.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

from __future__ import annotations

import os
import inspect
from typing import TYPE_CHECKING, Any, Type, Union, Generic, TypeVar, Callable, Optional, cast
from datetime import date, datetime
from typing_extensions import (
    Unpack,
    Literal,
    ClassVar,



#### 10. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/message_create_params.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import List, Union, Iterable
from typing_extensions import Literal, Required, TypeAlias, TypedDict

from .model_param import ModelParam
from .message_param import MessageParam
from .metadata_param import MetadataParam



#### 11. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/message_count_tokens_params.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Union, Iterable
from typing_extensions import Required, TypedDict

from .model_param import ModelParam
from .message_param import MessageParam
from .text_block_param import TextBlockParam



#### 12. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/message_create_params.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import List, Union, Iterable
from typing_extensions import Literal, Required, Annotated, TypedDict

from ..._utils import PropertyInfo
from ..model_param import ModelParam
from .beta_message_param import BetaMessageParam



#### 13. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/message_count_tokens_params.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import List, Union, Iterable
from typing_extensions import Required, Annotated, TypeAlias, TypedDict

from ..._utils import PropertyInfo
from ..model_param import ModelParam
from .beta_tool_param import BetaToolParam



#### 14. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/resources/models.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import httpx

from .. import _legacy_response
from ..types import model_list_params
from .._types import NOT_GIVEN, Body, Query, Headers, NotGiven
from .._utils import maybe_transform



#### 15. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/resources/completions.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import List
from typing_extensions import Literal, overload

import httpx

from .. import _legacy_response



#### 16. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/resources/beta/models.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import httpx

from ... import _legacy_response
from ..._types import NOT_GIVEN, Body, Query, Headers, NotGiven
from ..._utils import maybe_transform
from ..._compat import cached_property



#### 17. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/resources/beta/messages/messages.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import warnings
from typing import List, Union, Iterable
from functools import partial
from itertools import chain
from typing_extensions import Literal, overload




#### 18. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/resources/beta/messages/batches.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import List, Iterable
from itertools import chain

import httpx

from .... import _legacy_response



#### 19. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/resources/messages/messages.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import warnings
from typing import List, Union, Iterable
from functools import partial
from typing_extensions import Literal, overload

import httpx



#### 20. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/resources/messages/batches.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Iterable

import httpx

from ... import _legacy_response
from ..._types import NOT_GIVEN, Body, Query, Headers, NotGiven



#### 21. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/lib/bedrock/_client.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

from __future__ import annotations

import os
import urllib.parse
from typing import Any, Union, Mapping, TypeVar
from typing_extensions import Self, override

import httpx

from ... import _exceptions



#### 22. Multi-tenant system may lack proper tenant isolation in queries

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/lib/vertex/_client.py
- **Category**: Multi-tenancy
- **Recommendation**: Ensure all database queries filter by tenant ID to prevent data leakage between tenants

**Code Snippet**:

from __future__ import annotations

import os
from typing import TYPE_CHECKING, Any, Union, Mapping, TypeVar
from typing_extensions import Self, override

import httpx

from ... import _exceptions
from ._auth import load_auth, refresh_auth



#### 23. Potential prompt injection vulnerability with unsanitized user input

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/examples/text_completions_demo_sync.py
- **Category**: Prompt Security
- **Recommendation**: Sanitize user input before incorporating it into prompts and use clear role separation

**Code Snippet**:

#!/usr/bin/env -S poetry run python

import anthropic
from anthropic import Anthropic


def main() -> None:
    client = Anthropic()

    res = client.completions.create(



#### 24. Potential prompt injection vulnerability with unsanitized user input

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/examples/text_completions_streaming.py
- **Category**: Prompt Security
- **Recommendation**: Sanitize user input before incorporating it into prompts and use clear role separation

**Code Snippet**:

#!/usr/bin/env -S poetry run python

import asyncio

from anthropic import AI_PROMPT, HUMAN_PROMPT, Anthropic, APIStatusError, AsyncAnthropic

client = Anthropic()
async_client = AsyncAnthropic()

question = """



#### 25. Potential prompt injection vulnerability with unsanitized user input

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/examples/text_completions_demo_async.py
- **Category**: Prompt Security
- **Recommendation**: Sanitize user input before incorporating it into prompts and use clear role separation

**Code Snippet**:

#!/usr/bin/env -S poetry run python

import asyncio

import anthropic
from anthropic import AsyncAnthropic


async def main() -> None:
    client = AsyncAnthropic()



### MEDIUM Severity Findings (71)

#### 1. No encryption detected for data at rest

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/test_client.py
- **Category**: Data Protection
- **Recommendation**: Implement encryption for sensitive data stored in databases or files

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import gc
import os
import sys
import json
import time
import asyncio



#### 2. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/noxfile.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

import nox


@nox.session(reuse_venv=True, name="test-pydantic-v1")
def test_pydantic_v1(session: nox.Session) -> None:
    session.install("-r", "requirements-dev.lock")
    session.install("pydantic<2")

    session.run("pytest", "--showlocals", "--ignore=tests/functional", *session.posargs)



#### 3. Sensitive data may be logged

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/conftest.py
- **Category**: Data Protection
- **Recommendation**: Ensure sensitive data is not included in logs

**Code Snippet**:

from __future__ import annotations

import os
import logging
from typing import TYPE_CHECKING, Iterator, AsyncIterator

import pytest
from pytest_asyncio import is_async_test

from anthropic import Anthropic, AsyncAnthropic



#### 4. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/test_files.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from pathlib import Path

import anyio
import pytest
from dirty_equals import IsDict, IsList, IsBytes, IsTuple

from anthropic._files import to_httpx_files, async_to_httpx_files

readme_path = Path(__file__).parent.parent.joinpath("README.md")




#### 5. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/utils.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

import os
import inspect
import traceback
import contextlib
from typing import Any, TypeVar, Iterator, cast
from datetime import date, datetime
from typing_extensions import Literal, get_args, get_origin, assert_type




#### 6. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/test_models.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

import json
from typing import Any, Dict, List, Union, Optional, cast
from datetime import datetime, timezone
from typing_extensions import Literal, Annotated, TypeAliasType

import pytest
import pydantic
from pydantic import Field

from anthropic._utils import PropertyInfo



#### 7. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/test_client.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import gc
import os
import sys
import json
import time
import asyncio



#### 8. Sensitive data may be logged

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/test_client.py
- **Category**: Data Protection
- **Recommendation**: Ensure sensitive data is not included in logs

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import gc
import os
import sys
import json
import time
import asyncio



#### 9. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/test_utils/test_proxy.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

import operator
from typing import Any
from typing_extensions import override

from anthropic._utils import LazyProxy


class RecursiveLazyProxy(LazyProxy[Any]):
    @override
    def __load__(self) -> Any:



#### 10. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/lib/streaming/test_messages.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

import os
import inspect
from typing import Any, TypeVar, cast
from typing_extensions import Iterator, AsyncIterator

import httpx
import pytest
from respx import MockRouter



#### 11. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/api_resources/test_messages.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import os
from typing import Any, cast

import pytest

from anthropic import Anthropic, AsyncAnthropic



#### 12. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/api_resources/beta/test_messages.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import os
from typing import Any, cast

import pytest

from anthropic import Anthropic, AsyncAnthropic



#### 13. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/tests/api_resources/beta/messages/test_batches.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import os
import json
from typing import Any, cast

import httpx
import pytest



#### 14. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/examples/tools.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

from anthropic import Anthropic
from anthropic.types import ToolParam, MessageParam

client = Anthropic()

user_message: MessageParam = {
    "role": "user",
    "content": "What is the weather in SF?",



#### 15. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/examples/tools_stream.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

import asyncio

from anthropic import AsyncAnthropic

client = AsyncAnthropic()


async def main() -> None:
    async with client.messages.stream(
        max_tokens=1024,



#### 16. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/scripts/utils/ruffen-docs.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# fork of https://github.com/asottile/blacken-docs adapted for ruff
from __future__ import annotations

import re
import sys
import argparse
import textwrap
import contextlib
import subprocess
from typing import Match, Optional, Sequence, Generator, NamedTuple, cast



#### 17. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_types.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

from os import PathLike
from typing import (
    IO,
    TYPE_CHECKING,
    Any,
    Dict,
    List,
    Type,



#### 18. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_base_client.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

import sys
import json
import time
import uuid
import email
import socket
import asyncio
import inspect



#### 19. Sensitive data may be logged

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_base_client.py
- **Category**: Data Protection
- **Recommendation**: Ensure sensitive data is not included in logs

**Code Snippet**:

from __future__ import annotations

import sys
import json
import time
import uuid
import email
import socket
import asyncio
import inspect



#### 20. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_response.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

import os
import inspect
import logging
import datetime
import functools
from types import TracebackType
from typing import (
    TYPE_CHECKING,



#### 21. Sensitive data may be logged

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_response.py
- **Category**: Data Protection
- **Recommendation**: Ensure sensitive data is not included in logs

**Code Snippet**:

from __future__ import annotations

import os
import inspect
import logging
import datetime
import functools
from types import TracebackType
from typing import (
    TYPE_CHECKING,



#### 22. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_legacy_response.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

import os
import inspect
import logging
import datetime
import functools
from typing import (
    TYPE_CHECKING,
    Any,



#### 23. Sensitive data may be logged

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_legacy_response.py
- **Category**: Data Protection
- **Recommendation**: Ensure sensitive data is not included in logs

**Code Snippet**:

from __future__ import annotations

import os
import inspect
import logging
import datetime
import functools
from typing import (
    TYPE_CHECKING,
    Any,



#### 24. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/__init__.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from . import types
from ._types import NOT_GIVEN, Omit, NoneType, NotGiven, Transport, ProxiesTypes
from ._utils import file_from_path
from ._client import (
    Client,
    Stream,
    Timeout,
    Anthropic,



#### 25. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_files.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

import io
import os
import pathlib
from typing import overload
from typing_extensions import TypeGuard

import anyio




#### 26. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_streaming.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# Note: initially copied from https://github.com/florimondmanca/httpx-sse/blob/master/src/httpx_sse/_decoders.py
from __future__ import annotations

import abc
import json
import inspect
import warnings
from types import TracebackType
from typing import TYPE_CHECKING, Any, Generic, TypeVar, Iterator, AsyncIterator, cast
from typing_extensions import Self, Protocol, TypeGuard, override, get_origin, runtime_checkable



#### 27. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_models.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

import os
import inspect
from typing import TYPE_CHECKING, Any, Type, Union, Generic, TypeVar, Callable, Optional, cast
from datetime import date, datetime
from typing_extensions import (
    Unpack,
    Literal,
    ClassVar,



#### 28. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_compat.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

from typing import TYPE_CHECKING, Any, Union, Generic, TypeVar, Callable, cast, overload
from datetime import date, datetime
from typing_extensions import Self, Literal

import pydantic
from pydantic.fields import FieldInfo

from ._types import IncEx, StrBytesIntFloat



#### 29. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_utils/_proxy.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

from abc import ABC, abstractmethod
from typing import Generic, TypeVar, Iterable, cast
from typing_extensions import override

T = TypeVar("T")


class LazyProxy(Generic[T], ABC):



#### 30. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_utils/_reflection.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

import inspect
from typing import Any, Callable


def function_has_argument(func: Callable[..., Any], arg_name: str) -> bool:
    """Returns whether or not the given function has a specific parameter"""
    sig = inspect.signature(func)
    return arg_name in sig.parameters



#### 31. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_utils/_logs.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

import os
import logging

logger: logging.Logger = logging.getLogger("anthropic")
httpx_logger: logging.Logger = logging.getLogger("httpx")


def _basic_config() -> None:
    # e.g. [2023-10-05 14:12:26 - anthropic._base_client:818 - DEBUG] HTTP Request: POST http://127.0.0.1:4010/foo/bar "200 OK"
    logging.basicConfig(



#### 32. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_utils/_utils.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

import os
import re
import inspect
import functools
from typing import (
    Any,
    Tuple,
    Mapping,



#### 33. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_utils/_transform.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

import io
import base64
import pathlib
from typing import Any, Mapping, TypeVar, cast
from datetime import date, datetime
from typing_extensions import Literal, get_args, override, get_type_hints as _get_type_hints

import anyio



#### 34. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/tool_text_editor_20250124_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Optional
from typing_extensions import Literal, Required, TypedDict

from .cache_control_ephemeral_param import CacheControlEphemeralParam

__all__ = ["ToolTextEditor20250124Param"]



#### 35. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/tool_use_block_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Optional
from typing_extensions import Literal, Required, TypedDict

from .cache_control_ephemeral_param import CacheControlEphemeralParam

__all__ = ["ToolUseBlockParam"]



#### 36. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/tool_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Dict, Union, Optional
from typing_extensions import Literal, Required, TypeAlias, TypedDict

from .._models import set_pydantic_config
from .cache_control_ephemeral_param import CacheControlEphemeralParam




#### 37. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/message.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from typing import List, Optional
from typing_extensions import Literal

from .model import Model
from .usage import Usage
from .._models import BaseModel
from .stop_reason import StopReason
from .content_block import ContentBlock, ContentBlock as ContentBlock



#### 38. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/message_create_params.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import List, Union, Iterable
from typing_extensions import Literal, Required, TypeAlias, TypedDict

from .model_param import ModelParam
from .message_param import MessageParam
from .metadata_param import MetadataParam



#### 39. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/message_count_tokens_params.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Union, Iterable
from typing_extensions import Required, TypedDict

from .model_param import ModelParam
from .message_param import MessageParam
from .text_block_param import TextBlockParam



#### 40. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/tool_choice_tool_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing_extensions import Literal, Required, TypedDict

__all__ = ["ToolChoiceToolParam"]


class ToolChoiceToolParam(TypedDict, total=False):



#### 41. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/model_info.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from datetime import datetime
from typing_extensions import Literal

from .._models import BaseModel

__all__ = ["ModelInfo"]





#### 42. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/tool_bash_20250124_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Optional
from typing_extensions import Literal, Required, TypedDict

from .cache_control_ephemeral_param import CacheControlEphemeralParam

__all__ = ["ToolBash20250124Param"]



#### 43. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/tool_use_block.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from typing_extensions import Literal

from .._models import BaseModel

__all__ = ["ToolUseBlock"]


class ToolUseBlock(BaseModel):



#### 44. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_tool_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Dict, Union, Optional
from typing_extensions import Literal, Required, TypeAlias, TypedDict

from .beta_cache_control_ephemeral_param import BetaCacheControlEphemeralParam

__all__ = ["BetaToolParam", "InputSchema"]



#### 45. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_tool_computer_use_20250124_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Optional
from typing_extensions import Literal, Required, TypedDict

from .beta_cache_control_ephemeral_param import BetaCacheControlEphemeralParam

__all__ = ["BetaToolComputerUse20250124Param"]



#### 46. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_tool_bash_20241022_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Optional
from typing_extensions import Literal, Required, TypedDict

from .beta_cache_control_ephemeral_param import BetaCacheControlEphemeralParam

__all__ = ["BetaToolBash20241022Param"]



#### 47. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_tool_choice_tool_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing_extensions import Literal, Required, TypedDict

__all__ = ["BetaToolChoiceToolParam"]


class BetaToolChoiceToolParam(TypedDict, total=False):



#### 48. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_message.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from typing import List, Optional
from typing_extensions import Literal

from ..model import Model
from ..._models import BaseModel
from .beta_usage import BetaUsage
from .beta_stop_reason import BetaStopReason
from .beta_content_block import BetaContentBlock, BetaContentBlock as BetaContentBlock



#### 49. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_tool_use_block_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Optional
from typing_extensions import Literal, Required, TypedDict

from .beta_cache_control_ephemeral_param import BetaCacheControlEphemeralParam

__all__ = ["BetaToolUseBlockParam"]



#### 50. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_tool_bash_20250124_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Optional
from typing_extensions import Literal, Required, TypedDict

from .beta_cache_control_ephemeral_param import BetaCacheControlEphemeralParam

__all__ = ["BetaToolBash20250124Param"]



#### 51. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/message_create_params.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import List, Union, Iterable
from typing_extensions import Literal, Required, Annotated, TypedDict

from ..._utils import PropertyInfo
from ..model_param import ModelParam
from .beta_message_param import BetaMessageParam



#### 52. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_tool_computer_use_20241022_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Optional
from typing_extensions import Literal, Required, TypedDict

from .beta_cache_control_ephemeral_param import BetaCacheControlEphemeralParam

__all__ = ["BetaToolComputerUse20241022Param"]



#### 53. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_tool_text_editor_20250124_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Optional
from typing_extensions import Literal, Required, TypedDict

from .beta_cache_control_ephemeral_param import BetaCacheControlEphemeralParam

__all__ = ["BetaToolTextEditor20250124Param"]



#### 54. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/message_count_tokens_params.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import List, Union, Iterable
from typing_extensions import Required, Annotated, TypeAlias, TypedDict

from ..._utils import PropertyInfo
from ..model_param import ModelParam
from .beta_tool_param import BetaToolParam



#### 55. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_tool_use_block.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from typing_extensions import Literal

from ..._models import BaseModel

__all__ = ["BetaToolUseBlock"]


class BetaToolUseBlock(BaseModel):



#### 56. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_tool_text_editor_20241022_param.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Optional
from typing_extensions import Literal, Required, TypedDict

from .beta_cache_control_ephemeral_param import BetaCacheControlEphemeralParam

__all__ = ["BetaToolTextEditor20241022Param"]



#### 57. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/beta_model_info.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from datetime import datetime
from typing_extensions import Literal

from ..._models import BaseModel

__all__ = ["BetaModelInfo"]





#### 58. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/resources/beta/messages/messages.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import warnings
from typing import List, Union, Iterable
from functools import partial
from itertools import chain
from typing_extensions import Literal, overload




#### 59. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/resources/messages/messages.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

import warnings
from typing import List, Union, Iterable
from functools import partial
from typing_extensions import Literal, overload

import httpx



#### 60. Potential PII data without proper protection

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/lib/bedrock/_auth.py
- **Category**: Data Protection
- **Recommendation**: Implement masking, redaction, or encryption for personally identifiable information

**Code Snippet**:

from __future__ import annotations

from typing import TYPE_CHECKING

import httpx

from ..._utils import lru_cache

if TYPE_CHECKING:
    import boto3



#### 61. Dependency sniffio has no version specified, which may lead to using vulnerable versions

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/pyproject.toml
- **Category**: Dependencies
- **Recommendation**: Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions

**Code Snippet**:

[project]
name = "anthropic"
version = "0.50.0"
description = "The official Python library for the anthropic API"
dynamic = ["readme"]
license = "MIT"
authors = [
{ name = "Anthropic", email = "support@anthropic.com" },
]
dependencies = [



#### 62. Dependency mypy has no version specified, which may lead to using vulnerable versions

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/pyproject.toml
- **Category**: Dependencies
- **Recommendation**: Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions

**Code Snippet**:

[project]
name = "anthropic"
version = "0.50.0"
description = "The official Python library for the anthropic API"
dynamic = ["readme"]
license = "MIT"
authors = [
{ name = "Anthropic", email = "support@anthropic.com" },
]
dependencies = [



#### 63. Dependency respx has no version specified, which may lead to using vulnerable versions

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/pyproject.toml
- **Category**: Dependencies
- **Recommendation**: Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions

**Code Snippet**:

[project]
name = "anthropic"
version = "0.50.0"
description = "The official Python library for the anthropic API"
dynamic = ["readme"]
license = "MIT"
authors = [
{ name = "Anthropic", email = "support@anthropic.com" },
]
dependencies = [



#### 64. Dependency pytest has no version specified, which may lead to using vulnerable versions

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/pyproject.toml
- **Category**: Dependencies
- **Recommendation**: Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions

**Code Snippet**:

[project]
name = "anthropic"
version = "0.50.0"
description = "The official Python library for the anthropic API"
dynamic = ["readme"]
license = "MIT"
authors = [
{ name = "Anthropic", email = "support@anthropic.com" },
]
dependencies = [



#### 65. Dependency pytest-asyncio has no version specified, which may lead to using vulnerable versions

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/pyproject.toml
- **Category**: Dependencies
- **Recommendation**: Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions

**Code Snippet**:

[project]
name = "anthropic"
version = "0.50.0"
description = "The official Python library for the anthropic API"
dynamic = ["readme"]
license = "MIT"
authors = [
{ name = "Anthropic", email = "support@anthropic.com" },
]
dependencies = [



#### 66. Dependency ruff has no version specified, which may lead to using vulnerable versions

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/pyproject.toml
- **Category**: Dependencies
- **Recommendation**: Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions

**Code Snippet**:

[project]
name = "anthropic"
version = "0.50.0"
description = "The official Python library for the anthropic API"
dynamic = ["readme"]
license = "MIT"
authors = [
{ name = "Anthropic", email = "support@anthropic.com" },
]
dependencies = [



#### 67. Dependency time-machine has no version specified, which may lead to using vulnerable versions

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/pyproject.toml
- **Category**: Dependencies
- **Recommendation**: Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions

**Code Snippet**:

[project]
name = "anthropic"
version = "0.50.0"
description = "The official Python library for the anthropic API"
dynamic = ["readme"]
license = "MIT"
authors = [
{ name = "Anthropic", email = "support@anthropic.com" },
]
dependencies = [



#### 68. Dependency nox has no version specified, which may lead to using vulnerable versions

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/pyproject.toml
- **Category**: Dependencies
- **Recommendation**: Pin dependency versions to avoid automatic upgrades to potentially vulnerable versions

**Code Snippet**:

[project]
name = "anthropic"
version = "0.50.0"
description = "The official Python library for the anthropic API"
dynamic = ["readme"]
license = "MIT"
authors = [
{ name = "Anthropic", email = "support@anthropic.com" },
]
dependencies = [



#### 69. Sensitive configuration may not use environment variables

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/.github/workflows/create-releases.yml
- **Category**: Configuration
- **Recommendation**: Use environment variables for sensitive configuration values

**Code Snippet**:

name: Create releases
on:
  schedule:
    - cron: '0 5 * * *' # every day at 5am UTC
  push:
    branches:
      - main

jobs:
  release:



#### 70. Sensitive configuration may not use environment variables

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/.github/workflows/release-doctor.yml
- **Category**: Configuration
- **Recommendation**: Use environment variables for sensitive configuration values

**Code Snippet**:

name: Release Doctor
on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  release_doctor:
    name: release doctor



#### 71. Sensitive configuration may not use environment variables

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/.github/workflows/publish-pypi.yml
- **Category**: Configuration
- **Recommendation**: Use environment variables for sensitive configuration values

**Code Snippet**:

# workflow for re-running publishing to PyPI in case it fails for some reason
# you can run this workflow by navigating to https://www.github.com/anthropics/anthropic-sdk-python/actions/workflows/publish-pypi.yml
name: Publish PyPI
on:
  workflow_dispatch:

jobs:
  publish:
    name: publish
    runs-on: ubuntu-latest



### LOW Severity Findings (16)

#### 1. Prompts may not use clear role separation

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/examples/text_completions_demo_sync.py
- **Category**: Prompt Security
- **Recommendation**: Use explicit role separation (system/user/assistant) in prompts

**Code Snippet**:

#!/usr/bin/env -S poetry run python

import anthropic
from anthropic import Anthropic


def main() -> None:
    client = Anthropic()

    res = client.completions.create(



#### 2. Prompts may not use clear role separation

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/examples/text_completions_streaming.py
- **Category**: Prompt Security
- **Recommendation**: Use explicit role separation (system/user/assistant) in prompts

**Code Snippet**:

#!/usr/bin/env -S poetry run python

import asyncio

from anthropic import AI_PROMPT, HUMAN_PROMPT, Anthropic, APIStatusError, AsyncAnthropic

client = Anthropic()
async_client = AsyncAnthropic()

question = """



#### 3. Prompts may not use clear role separation

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/examples/text_completions_demo_async.py
- **Category**: Prompt Security
- **Recommendation**: Use explicit role separation (system/user/assistant) in prompts

**Code Snippet**:

#!/usr/bin/env -S poetry run python

import asyncio

import anthropic
from anthropic import AsyncAnthropic


async def main() -> None:
    client = AsyncAnthropic()



#### 4. Prompts may not use clear role separation

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/scripts/utils/ruffen-docs.py
- **Category**: Prompt Security
- **Recommendation**: Use explicit role separation (system/user/assistant) in prompts

**Code Snippet**:

# fork of https://github.com/asottile/blacken-docs adapted for ruff
from __future__ import annotations

import re
import sys
import argparse
import textwrap
import contextlib
import subprocess
from typing import Match, Optional, Sequence, Generator, NamedTuple, cast



#### 5. Prompts may not use clear role separation

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/completion.py
- **Category**: Prompt Security
- **Recommendation**: Use explicit role separation (system/user/assistant) in prompts

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from typing import Optional
from typing_extensions import Literal

from .model import Model
from .._models import BaseModel

__all__ = ["Completion"]




#### 6. Prompts may not use clear role separation

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/anthropic_beta_param.py
- **Category**: Prompt Security
- **Recommendation**: Use explicit role separation (system/user/assistant) in prompts

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Union
from typing_extensions import Literal, TypeAlias

__all__ = ["AnthropicBetaParam"]

AnthropicBetaParam: TypeAlias = Union[



#### 7. Prompts may not use clear role separation

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta/messages/batch_create_params.py
- **Category**: Prompt Security
- **Recommendation**: Use explicit role separation (system/user/assistant) in prompts

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import List, Iterable
from typing_extensions import Required, Annotated, TypedDict

from ...._utils import PropertyInfo
from ...anthropic_beta_param import AnthropicBetaParam
from ..message_create_params import MessageCreateParamsNonStreaming



#### 8. Prompts may not use clear role separation

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/messages/batch_create_params.py
- **Category**: Prompt Security
- **Recommendation**: Use explicit role separation (system/user/assistant) in prompts

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from typing import Iterable
from typing_extensions import Required, TypedDict

from ..message_create_params import MessageCreateParamsNonStreaming

__all__ = ["BatchCreateParams", "Request"]



#### 9. Rate limiting may not be user-specific

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta_rate_limit_error.py
- **Category**: Rate Limiting
- **Recommendation**: Implement per-user rate limiting to prevent individual users from consuming all resources

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from typing_extensions import Literal

from .._models import BaseModel

__all__ = ["BetaRateLimitError"]


class BetaRateLimitError(BaseModel):



#### 10. Rate limiting may not be user-specific

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/__init__.py
- **Category**: Rate Limiting
- **Recommendation**: Implement per-user rate limiting to prevent individual users from consuming all resources

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from __future__ import annotations

from .model import Model as Model
from .usage import Usage as Usage
from .shared import (
    ErrorObject as ErrorObject,
    BillingError as BillingError,
    ErrorResponse as ErrorResponse,



#### 11. Rate limiting may not be user-specific

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/beta_error.py
- **Category**: Rate Limiting
- **Recommendation**: Implement per-user rate limiting to prevent individual users from consuming all resources

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from typing import Union
from typing_extensions import Annotated, TypeAlias

from .._utils import PropertyInfo
from .beta_api_error import BetaAPIError
from .beta_billing_error import BetaBillingError
from .beta_not_found_error import BetaNotFoundError
from .beta_overloaded_error import BetaOverloadedError



#### 12. Rate limiting may not be user-specific

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/shared/error_object.py
- **Category**: Rate Limiting
- **Recommendation**: Implement per-user rate limiting to prevent individual users from consuming all resources

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from typing import Union
from typing_extensions import Annotated, TypeAlias

from ..._utils import PropertyInfo
from .billing_error import BillingError
from .not_found_error import NotFoundError
from .api_error_object import APIErrorObject
from .overloaded_error import OverloadedError



#### 13. Rate limiting may not be user-specific

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/shared/__init__.py
- **Category**: Rate Limiting
- **Recommendation**: Implement per-user rate limiting to prevent individual users from consuming all resources

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from .error_object import ErrorObject as ErrorObject
from .billing_error import BillingError as BillingError
from .error_response import ErrorResponse as ErrorResponse
from .not_found_error import NotFoundError as NotFoundError
from .api_error_object import APIErrorObject as APIErrorObject
from .overloaded_error import OverloadedError as OverloadedError
from .permission_error import PermissionError as PermissionError
from .rate_limit_error import RateLimitError as RateLimitError



#### 14. Rate limiting may not be user-specific

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/types/shared/rate_limit_error.py
- **Category**: Rate Limiting
- **Recommendation**: Implement per-user rate limiting to prevent individual users from consuming all resources

**Code Snippet**:

# File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

from typing_extensions import Literal

from ..._models import BaseModel

__all__ = ["RateLimitError"]


class RateLimitError(BaseModel):



#### 15. Debug logging may be enabled in production

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_response.py
- **Category**: Logging
- **Recommendation**: Ensure debug logging is only enabled in development environments

**Code Snippet**:

from __future__ import annotations

import os
import inspect
import logging
import datetime
import functools
from types import TracebackType
from typing import (
    TYPE_CHECKING,



#### 16. Debug logging may be enabled in production

- **File**: /var/folders/71/yhn7_f3925qd6xz43prhz6fm0000gp/T/tmpaqk0od5g/src/anthropic/_legacy_response.py
- **Category**: Logging
- **Recommendation**: Ensure debug logging is only enabled in development environments

**Code Snippet**:

from __future__ import annotations

import os
import inspect
import logging
import datetime
import functools
from typing import (
    TYPE_CHECKING,
    Any,



